<ion-view title="GroupsPage" hide-nav-bar="true" id="page3">

  <div class="bar bar-header bar-energized">
    <a class="button icon-left ion-arrow-left-c button-energized" ng-click="data.backToGroupPage()"></a>
    <h1 class="title chatTitle">{{groupObjects[group_id].group_name | nameShortener}}</h1>
  </div>

  <ion-content class="has-header" on-swipe-right="data.backToGroupPage()">

    <img ng-hide="imgURI !== undefined" ng-src="{{groupObjects[group_id].group_photo}}" class="groupInfoPic" alt=""> <!--TODO show placeholder and format -->
    <img ng-hide="imgURI === undefined" ng-src="{{imgURI}}" class="groupInfoPic" alt=""> <!--TODO show placeholder and format -->

    <div class="row" ng-if="admin">
      <button class="col-50 button button-tangerine" ng-click="data.takePhoto()">Take New Photo</button>
      <button class="col-50 button button-tangerine" ng-click="data.choosePhoto()">Choose New Photo</button>
    </div>

    <h1 class="groupInfoTitle">{{groupObjects[group_id].group_name}} <a ng-if="admin" ng-click="editGroupName()" href="">Edit</a></h1>

    <p class="groupInfoDescription">{{groupObjects[group_id].description}} <a ng-if="admin" ng-click="editGroupDescription()" href="">Edit</a></p>

    <li class="item">
      Group Members

      <ion-item ng-repeat="member in groupMembers" class="item item-avatar" ng-click="newPersonalMessage()">
        <img ng-src="{{member.portrait_link}}" alt="">
        <h3>{{member.first_name}} {{member.last_name}}</h3>

        <i class="icon ion-close-round removeGroupMember" ng-if="admin && !member.admin" ng-click="removeUserFromGroup(group_id, member.user_id, member.first_name, member.last_name, groupObjects[group_id].group_name)"></i>

        <i class="icon ion-ribbon-b energized adminBadge" ng-if="member.admin"></i>

        <i class="icon ion-ribbon-b makeGroupMemberAdmin" ng-if='!member.admin && admin' ng-click="makeUserAdmin(group_id, member.user_id)"></i>

      </ion-item>

    </li>

    <li class="item item-text-wrap">
      Invite New Members
      <br>
      <div class="list invitedList" ng-repeat="member in data.invited" ng-show="data.invited.length > 0">
        <span class="invitedToGroup" ng-click="data.removeInvitation(member)">{{member.name}} | X</span>
      </div>

      <div class="list">
        <label class="item item-input item-floating-label">
          <span class="input-label">Contact Name or (xxx) xxx-xxxx</span>
          <input type="text" placeholder="Enter Name Here" ng-model="data.memberSearch" ng-change="data.showContacts()">
        </label>
      </div>

      <ul class="list" ng-show="data.memberSearch.length > 0">
        <div ng-repeat="contact in data.contacts | filter:data.memberSearch | limitTo:4">
          <li ng-repeat="phone in contact.phoneNumbers" class="item animated fadeInUp" ng-click="data.inviteToGroup(contact.name.formatted, phone.value)">
            {{contact.name.formatted}}: {{phone.value}}
          </li>
        </div>
      </ul>

      <button class="button button-block button-tangerine" ng-click="data.sendInvitations()" ng-show="data.invited.length > 0">Send Invitations</button>

    </li>

    <li class="item">
      <button class="button button-block button-assertive" ng-click="leaveGroup(groupObjects[group_id].group_name)">Leave Group</button>
      <button class="button button-block button-assertive" ng-if="admin" ng-click="deleteGroup(group_id, groupObjects[group_id].group_name)">Delete Group</button>
    </li>

  </ion-content>
</ion-view>
